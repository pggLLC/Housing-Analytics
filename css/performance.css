/* ================================================================
   performance.css — LIHTC Analytics Hub
   GPU-acceleration hints, paint-containment, and layout
   optimizations for smooth 60 fps rendering.
   ================================================================ */

/* ----------------------------------------------------------------
   1. WILL-CHANGE HINTS
      Reserve compositor layers only for elements that actually
      animate — over-using will-change wastes GPU memory.
   ---------------------------------------------------------------- */
.feature-card,
.btn,
.btn-primary {
  will-change: transform;
}

nav.site-nav a,
.pill,
.badge,
.tag {
  will-change: background-color, color;
}

header.site-header {
  will-change: backdrop-filter;
}

/* ----------------------------------------------------------------
   2. GPU ACCELERATION — smooth scroll & fixed elements
   ---------------------------------------------------------------- */
header.site-header {
  transform: translateZ(0);       /* promote to own compositor layer */
  -webkit-transform: translateZ(0);
}

.dark-mode-toggle {
  transform: translateZ(0);
}

/* ----------------------------------------------------------------
   3. CONTAIN — hint to browser that component subtrees are isolated
   ---------------------------------------------------------------- */
.card,
.kpi-card,
.stat-card,
.panel,
.tile,
.metric,
.chart-card {
  contain: layout style;
}

.table-container {
  contain: layout;
}

/* ----------------------------------------------------------------
   4. EFFICIENT SELECTORS
      Avoid deep descendant chains. These utilities keep specificity
      flat so the cascade stays fast.
   ---------------------------------------------------------------- */

/* Font-display: swap is set in the Google Fonts URL (@import in site-theme.css).
   The rule below is a safety net for any self-hosted @font-face blocks. */
@font-face {
  font-display: swap;           /* prevent invisible text during load */
}

/* ----------------------------------------------------------------
   5. LAZY LOADING SUPPORT
      Native lazy-loading is set via the `loading="lazy"` HTML
      attribute. This CSS provides the placeholder background while
      images load.
   ---------------------------------------------------------------- */
img[loading="lazy"],
iframe[loading="lazy"] {
  background: var(--bg2);
}

/* ----------------------------------------------------------------
   6. IMAGE RENDERING
   ---------------------------------------------------------------- */
img {
  image-rendering: auto;         /* let the browser choose the best algorithm */
}

/* Charts / SVG illustrations — crisp pixel rendering */
canvas,
svg {
  image-rendering: crisp-edges;
}

/* ----------------------------------------------------------------
   7. SCROLL PERFORMANCE
   ---------------------------------------------------------------- */
html {
  scroll-behavior: smooth;
}

@media (prefers-reduced-motion: reduce) {
  html { scroll-behavior: auto; }
}

/* Passive scroll listeners are set in JS. This property hints at
   over-scrolling behaviour to avoid jank on iOS. */
.table-container,
.leaflet-container {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* ----------------------------------------------------------------
   8. CRITICAL RENDERING PATH NOTES (comments only)
   ---------------------------------------------------------------- */
/*
  CRITICAL CSS INLINE RECOMMENDATIONS
  ─────────────────────────────────────
  The following selectors should be inlined in <style> in <head>
  to avoid render-blocking for above-the-fold content:

  - :root variables (design tokens)
  - html, body base styles
  - header.site-header
  - .nav-wrap, .brand, nav.site-nav
  - main first-child layout
  - h1, h2 typography

  All other rules can remain in external CSS files loaded with
  <link rel="stylesheet"> (non-blocking via preload pattern):

    <link rel="preload" href="css/site-theme.css" as="style"
          onload="this.onload=null;this.rel='stylesheet'">
*/

/* ----------------------------------------------------------------
   9. FONT LOADING OPTIMIZATION
   ---------------------------------------------------------------- */
/*
  Fonts are loaded via Google Fonts @import with `display=swap`
  appended to the URL in site-theme.css. For self-hosted fonts,
  use the @font-face above with font-display: swap and preload:

    <link rel="preload" href="fonts/PlusJakartaSans.woff2"
          as="font" type="font/woff2" crossorigin>
*/

/* ----------------------------------------------------------------
   10. REDUCE PAINT AREAS — clip overflow on containers
   ---------------------------------------------------------------- */
.card,
.panel,
.tile,
.kpi-card,
.table-container {
  overflow: hidden;
}

/* Restore overflow for dropdowns and tooltips */
.toolbar,
.controls-row {
  overflow: visible;
}
